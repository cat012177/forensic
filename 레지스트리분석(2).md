전 시간에 이어서, 레지스트리 편집기에서 알 수 있는 정보를 실습해보겠다.

 

4. 공유 폴더

여러대의 컴퓨터가 하나의 폴더를 사용하는 것. 다음 경로에 들어가면 운영 체제에서 설정한 공유 폴더에 대한 정보가 레지스트리에 기록된다. 



아직 공유폴더를 사용하지 않아 아무것도 없다.
 

그렇다면 공유 폴더가 생기면 뭐가 달라질까? 싶어서 갖고있던 파일 중 하나를 공유 폴더로 만들어보았다.

공유 폴더 생성 방법은 폴더 우클릭>속성>공유 에 들어가서 공유 설정을 하면 된다.


현재 파일 공유가 설정된 모습.(윈보운 과제 때 쓰던 폴더다...)
공유 폴더를 만들어준 후 다시 들어가봤더니 전과 달리 이렇게 새로운 값이 생겼다.


값 데이터를 열어보면 다음과 같이 다양한 값이 적혀있는 것을 볼 수 있다.(CATimeout과 CSCflags가 뭔지는 정확히 알아내지 못 했다..)

 


5. 서비스

레지스트리 키 경로는 다음과 같다.

경로에 들어가면 무수히 많은 파일이 있는 것을 볼 수 있는데, 프로그램이 설치되거나 일부 프로그램이 자동 실행을 등록하는 경우, 해당 프로그램에 대한 정보가 레지스트리에 기록된다.

또한, 일부 악성코드에 경우 악성 코드 실행이 영구히 지속되도록 하기 위해 서비스에 등록하는 경우가 있는데, 이 서비스 목록을 확인하여 악성코드에 감염되었는지, 아닌지를 알 수 있다.


windows 레지스트리 악성코드 정보 :: BLOG.AACII.NET

 
windows 레지스트리 악성코드 정보

명령 프롬프트 실행시 자동으로 실행 되는 프로그램 관련 레지스트리 HKLM(HKCU)\SOFTWARE\Microsoft\Command Processor 하위에 AutoRun 키를 생성 후 프로그램을 등록하면 명령프롬프트 실행시 자동 실행되는

blog.aacii.net
위 사이트는 레지스트리를 확인해 알 수 있는 악성 코드를 기록한 개인 홈페이지이다.

 

6.응용 프로그램 설치/제거

윈도우 운영체제에서 삭제되거나 설치한 프로그램의 정보를 알 수 있다.

경로는 다음과 같고, 경로를 통해 들어가면 하위 폴더로 지금까지 설치한 프로그램의 이름으로 레지스트리 키가 생성되어있는 것을 볼 수 있다. 



설치한 프로그램 이름으로 키 생성
좀 더 들어가서 다음 경로로 들어가면 설치한 프로그램 목록이 레지스트리 키로 하위 폴더로 생성되어 있다.



다음은 삭제된 프로그램을 보는 경로이다. 경로로 들어가면 설치된 프로그램을 보았던 것과 달리, 프로그램의 이름이 아니라 프로그램의 고유 값으로 기록되어 있는 것을 확인할 수 있다.



하지만 모든 항목이 고유 값으로 적혀있는 것은 아니고, 다음과 같이 프로그램 명으로 되어있는 것도 있었다.


키에 대한 값으로는 프로그램의 설치 경로와 설치 시간 등이 기록되어있다.

 

7.사용자 행위 분석

레지스트리 키 경로는 다음과 같다.


레지스트리에는 사용자 행위에 대한 정보를 기록하고 있다. 이러한 정보를 통해서 사용자의 선호 사용 파일이나 응용 프로그램에 대해 알 수 있다. 또한 사용자가 입력한 키워드 정보, 공유, 사이트 접속 기록도 알 수 있다.

 

들어가면 아래 사진과 같이 확장자 별로 하위 폴더가 정리되어 있는 것을 볼 수 있고, 각각의 확장자 하위 값을 분석하여 실행됐던 파일 정보를 확인할 수 있다.


"MRUListEX" 데이터는 가장 최근에 실행된 순서를 기록하고 있는데, 나머지 값의 이름은 숫자로 생성되어 있다. 숫자 값의 데이터는 파일 이름이 저장된 것이다. 


실행파일이 다수인 경우 다음과 같이 0,1,2,3... 으로 레지스트리 값이 생성된다.
파일 이름이 영문인 경우는 바로 확인할 수 있으나, 한글 이름인 파일은 유니코드로 변경해서 확인해야 한다. 따라서 한글 이름인 파일은 별도의 포렌식 도구를 이용해 이름을 확인할 수 있다.


영문인 경우는 다음과 같이 이름을 바로 확인할 수 있다.(flag2.jpg)
8. 설치된 프로그램을 통해 실행된 파일, 저장된 파일 정보 확인

comdlg32 레지스트리 키 하위 키로 존재하는 서브 키 중 "LastVistedPidlMRU"와 "OpenSavedPidlMRU" 키에 사용자의 행위가 기록되어 있다. 우선 경로는 다음과 같다.



LastVistedPidlMRU 안 내용. 
 

LastVistedPidlMRU에는 사용자가 최근 실행한 프로그램에서 열어본 하위 폴더 목록을 저장하고 있다. OpenSavedPidlMRU에는 사용자가 윈도우 다이얼로그 창을 띄워서 저장하거나 실행한 파일 목록이 저장된다. 이러한 정보를 포렌식 도구를 이용하면 사용자가 특정 프로그램을 통해 실행한 파일과 저장된 파일 이름을 확인 가능하다.


LastVistedPidlMRU에서 확인한 데이터. exe파일 이름이 영문이라 이름이 그대로 영문으로 나온 것을 볼 수 있다.
 

9. 윈도우 실행을 열어 입력한 데이터 확인

RunMRU에는 윈도우+R 단축키 또는 윈도우 "실행"을 열어 사용자가 입력한 데이터가 저장되어 있다.

특정 경로를 찾아가기 위해서, 또는 파일이나 프로그램을 실행하기 위해 실행창을 사용할 수 있는데 이렇게 사용자가 입력한 경로나 파일명 등을 통해 사용자가 특정 폴더나 파일의 존재 유무를 알고 있다는 증명이 가능하다.


 


RunMRU에 기록된 값은 알파벳으로 기록되는데, 위 사진에서는 MRUList에 a가 써있고 a에 regedit\1이 데이터로 기록되어 있으므로 사용자가 윈도우 실행으로 레지스트리 편집기를 실행했다는 것을 알 수 있다. 실행한 파일이나 프로그램이 다수가 되면 MRUList가 다음과 같이 변한다.


MRUList 값이 ba로 변한 것을 알 수 있다. 이는 사용자가 b 작업을 가장 최근에 실행하고, a 작업을 가장 나중에 실행했다는 것을 의미한다. 따라서 a>b 순으로 작업했다는 것을 알 수 있다.

(이미지에서는 레지스트리 편집기를 사용한 뒤, 네이버를 실행했다는 것을 알 수 있다.)

 

10. 파일 탐색기에서 사용자가 입력한 키워드 정보

사용자가 입력한 키워드 또는 경로 목록이 저장되어있다. (검색 바에 입력한 정보는 WordWheelQuery로 볼 수 있다고 써있으나 윈도우 11 레지스트리 편집기에서는 WordWheelQuery 항목을 찾을 수 없었다.) 경로는 다음과 같다.



경로를 통해 들어가면 위 사진과 같이 파일 탐색기에서 입력한 경로가 기록되어 있는 것을 볼 수 있다. RunMRU와 비슷하지만 MRUList와 같이 순서를 나타내는 파일은 존재하지 않는다. 파일 탐색기에서 사용자가 직접 검색한 파일의 경로만 표시되고, 그 경로를 통해 들어간 폴더나 프로그램 명은 표시되지 않는다.